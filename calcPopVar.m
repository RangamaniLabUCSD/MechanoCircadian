%% load stored data
load('FibroblastStiffnessPeriod.mat')
load('FibroblastStiffnessAmpl.mat')
load('FibroblastROCKInhibPeriod.mat')
load('FibroblastROCKInhibAmpl.mat')
load('FibroblastCytDPeriod.mat')
load('FibroblastCytDAmpl.mat')
load('FibroblastJasPeriod.mat')
load('FibroblastJasAmpl.mat')
load('FibroblastLatBPeriod.mat')
load('FibroblastLatBAmpl.mat')
meanFibroblastControlPeriod = (4*FibroblastStiffnessPeriod(1,1) +...
        3*FibroblastROCKInhibPeriod(1,1) + 3*FibroblastCytDPeriod(1,1) +...
        3*FibroblastLatBPeriod(1,1) + 3*FibroblastJasPeriod(1,1))/16;
stdFibroblastControlPeriod = sqrt((4*FibroblastStiffnessPeriod(1,2) +...
        3*FibroblastROCKInhibPeriod(1,2) + 3*FibroblastCytDPeriod(1,2) +...
        3*FibroblastLatBPeriod(1,2) + 3*FibroblastJasPeriod(1,2))/16);
meanFibroblastControlAmpl = (4*FibroblastStiffnessAmpl(1,1) +...
        3*FibroblastROCKInhibAmpl(1,1) + 3*FibroblastCytDAmpl(1,1) +...
        3*FibroblastLatBAmpl(1,1) + 3*FibroblastJasAmpl(1,1))/16;
stdFibroblastControlAmpl = sqrt((4*FibroblastStiffnessAmpl(1,2) +...
        3*FibroblastROCKInhibAmpl(1,2) + 3*FibroblastCytDAmpl(1,2) +...
        3*FibroblastLatBAmpl(1,2) + 3*FibroblastJasAmpl(1,2))/16);
% FibroblastStiffnessPeriod(1,:) = [meanFibroblastControlPeriod, stdFibroblastControlPeriod];
% FibroblastStiffnessAmpl(1,:) = [meanFibroblastControlAmpl, stdFibroblastControlAmpl];
% FibroblastROCKInhibPeriod(1,:) = [meanFibroblastControlPeriod, stdFibroblastControlPeriod];
% FibroblastROCKInhibAmpl(1,:) = [meanFibroblastControlAmpl, stdFibroblastControlAmpl];
% FibroblastCytDPeriod(1,:) = [meanFibroblastControlPeriod, stdFibroblastControlPeriod];
% FibroblastCytDAmpl(1,:) = [meanFibroblastControlAmpl, stdFibroblastControlAmpl];
% FibroblastLatBPeriod(1,:) = [meanFibroblastControlPeriod, stdFibroblastControlPeriod];
% FibroblastLatBAmpl(1,:) = [meanFibroblastControlAmpl, stdFibroblastControlAmpl];
% FibroblastJasPeriod(1,:) = [meanFibroblastControlPeriod, stdFibroblastControlPeriod];
% FibroblastJasAmpl(1,:) = [meanFibroblastControlAmpl, stdFibroblastControlAmpl];

%% Generate random samples
numSamples = 1e4;
tSample = 0:.25:7*24;
periodVec = [23.8447, 24.5874, 25.5922,...
             24.7122, 25.1024, 25.1707,...
             24.2103, 24.9957, 24.9700, 24.6352,...
             24.9389, 25.4105, 25.9694,...
             23.6788, 23.2228, 22.3938, 20.4041];
periodStdVec = [0.1748, 0.2330, 0.3350,...
                0.1659, 0.2341, 0.3024,...
                0.2060, 0.1803, 0.0258, 0.3991,...
                0.1048, 0.1921, 0.2620,...
                0.2487, 0.2902, 0.4145, 0.1658];
amplVec = [1, 2.2948, 1.9392,...
           1, 1.3063, 1.1532,...
           1, 1.2874, 1.6552, 1.9425,...
           1, 1.6118, 2.3765,...
           1, 0.9531, 1.0938, 0.2969];
amplStdVec = [0.3739, 0.1094, 0.2553,...
              0.0090, 0.1081, 0.1081,...
              0.1954, 0.1494, 0.3218, 0.3908,...
              0.0235, 0.1412, 0.0588,...
              0.1250, 0.1797, 0.2344, 0.0703];
numConditions = length(periodVec);
meanDynVals = zeros(numConditions, length(tSample));
stdDynVals = zeros(numConditions, length(tSample));
figure
hold on
for i = 1:numConditions
    randVals = randn([numSamples, 2]);
    dynMat = zeros(numSamples,length(tSample));
    for j = 1:numSamples
        periodCur = periodVec(i) + periodStdVec(i)*randVals(j,1);
        amplCur = amplVec(i) + amplStdVec(i)*randVals(j,2);
        dynMat(j,:) = 0.5*amplCur*(cos(2*pi*tSample/(periodCur)));
        % plot(tSample, dynMat(j,:))
    end
    meanDynVals(i,:) = mean(dynMat,1);
    stdDynVals(i,:) = std(dynMat,1);
    % figure
    errorbar(tSample, meanDynVals(i,:), stdDynVals(i,:), stdDynVals(i,:))
    % plot(tSample, 0.5*amplVec(i)*(cos(2*pi*tSample/(periodVec(i)))))
end

%% sample from posterior dist
